- name: deploy qualys agent
  collections:
    - ansible.windows
  hosts: all
  tasks:
    - name: Copiar arquivo para o destino
      ansible.builtin.copy:
       src: "QualysCloudAgent.exe"
       dest: C:\temp\

    - name: Ensure Qualys Cloud Agent is installed
      win_package:
        path: c:\temp\QualysCloudAgent.exe
        product_id: "QualysCloudAgent" # Or the actual Product ID if different
        state: present
        arguments:
          - "/qn" # Silent installation
          - "CustomerId={{ CustomerId }}"
          - "ActivationId={{ ActivationId }}"
          - "WebServiceUri={{ WebServiceUri }}"
      register: qualys_agent_install_result

    - name: Display installation result
      debug:
        var: qualys_agent_install_result
